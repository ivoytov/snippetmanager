{% extends 'base.html' %}

{% block content %}
    <h2>Chat</h2>
    <form method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Send</button>
    </form>

    {% if response %}
        <h3>Response from AI</h3>
        <p>{{ response }}</p>
    {% endif %}

    {% if used_snippets %}
        <h3>Snippets Included in the Prompt</h3>
        <ul>
        {% for snippet in used_snippets %}
            <li>
                <a href="{% url 'read_document' project_id snippet.metadata.document_id %}?start_char_idx={{ snippet.node.start_char_idx }}&end_char_idx={{ snippet.node.end_char_idx}}" target="_blank">
                {{ snippet.metadata.name }}
                </a>
            </li>
        {% endfor %}
        </ul>
    {% endif %}

    <a href="{% url 'project_detail' project_id %}" class="btn btn-primary">Back to Project Files</a>

{% endblock %}